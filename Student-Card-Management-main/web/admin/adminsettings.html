<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Settings | Shuleni Advantage</title>
  <link rel="icon" href="../shared/favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="shared-admin-styles.css">
  <style>
    /* Page-specific styles only - base styles are in shared-admin-styles.css */

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 25px 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.15);
      margin-bottom: 10px;
      background: rgba(255, 255, 255, 0.05);
    }

    .brand-icon {
      width: 45px;
      height: 45px;
      object-fit: contain;
      filter: none;
      transition: var(--transition);
    }

    .brand:hover .brand-icon {
      transform: scale(1.05);
    }

    .brand h1 {
      font-size: 1.3rem;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .nav-links {
      list-style: none;
      flex: 1;
      padding: 10px 0;
    }

    .nav-links li {
      margin-bottom: 4px;
      padding: 0 12px;
    }

    .nav-links a {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 16px;
      color: rgba(255, 255, 255, 0.85);
      text-decoration: none;
      transition: var(--transition);
      border-radius: 10px;
      font-weight: 500;
      position: relative;
    }

    .nav-links a::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 0;
      background: var(--accent-color);
      border-radius: 0 3px 3px 0;
      transition: var(--transition);
    }

    .nav-links a:hover {
      background: rgba(255, 255, 255, 0.12);
      color: white;
      transform: translateX(4px);
    }

    .nav-links a.active {
      background: rgba(255, 255, 255, 0.15);
      color: white;
      font-weight: 600;
    }

    .nav-links a.active::before {
      height: 60%;
    }

    .nav-icon {
      width: 20px;
      height: 20px;
      fill: currentColor;
      flex-shrink: 0;
    }

    .logout-section {
      padding: 20px 12px;
      border-top: 1px solid rgba(255, 255, 255, 0.15);
      margin-top: auto;
      background: rgba(0, 0, 0, 0.1);
    }

    .logout-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      padding: 14px 16px;
      background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
    }

    .logout-btn:hover {
      background: linear-gradient(135deg, #b91c1c 0%, #dc2626 100%);
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4);
      border-color: rgba(239, 68, 68, 0.5);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
    }

    .logout-icon {
      width: 20px;
      height: 20px;
      fill: currentColor;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: 35px 40px;
      overflow-y: auto;
      margin-left: 260px;
      background: var(--beige-bg);
      min-height: 100vh;
    }

    .top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 35px;
      padding-bottom: 20px;
      border-bottom: 2px solid rgba(74, 53, 16, 0.1);
    }

    .top-row h1,
    .top-row h2 {
      font-size: 2rem;
      color: var(--primary-color);
      font-weight: 700;
      letter-spacing: -0.5px;
    }

    .admin-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    #adminInfo {
      background: linear-gradient(135deg, white 0%, #fefefe 100%);
      padding: 10px 20px;
      border-radius: 25px;
      box-shadow: var(--box-shadow);
      font-size: 0.95rem;
      color: var(--primary-color);
      font-weight: 500;
      border: 1px solid rgba(74, 53, 16, 0.1);
    }

    .logout-btn-top {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 20px;
      background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%) !important;
      color: white !important;
      border: none !important;
      border-radius: 25px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
    }

    .logout-btn-top:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(220, 38, 38, 0.4);
      background: linear-gradient(135deg, #b91c1c 0%, #dc2626 100%) !important;
    }

    .logout-icon-top {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    /* Settings Cards */
    .card {
      background: linear-gradient(135deg, white 0%, #fefefe 100%);
      border-radius: var(--border-radius);
      padding: 30px;
      box-shadow: var(--box-shadow);
      margin-bottom: 30px;
      border: 1px solid rgba(74, 53, 16, 0.08);
    }

    .card h3 {
      font-size: 1.3rem;
      color: var(--primary-color);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #eee;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 10px;
      margin-bottom: 20px;
    }

    .form-row {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .form-control {
      flex: 1;
      min-width: 250px;
    }

    label {
      font-weight: 500;
      color: var(--primary-color);
      font-size: 0.9rem;
      margin-bottom: 5px;
    }

    input,
    select {
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 1rem;
      transition: var(--transition);
      width: 100%;
    }

    input:focus,
    select:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 2px rgba(139, 107, 61, 0.2);
    }

    .btn {
      padding: 12px 20px;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
      border: none;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
      border: none;
      box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
    }

    .btn-secondary:hover {
      background: linear-gradient(135deg, #00f2fe 0%, #4facfe 100%);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
    }

    .btn-danger {
      background: linear-gradient(135deg, var(--danger-color) 0%, #dc2626 100%);
      color: white;
      box-shadow: 0 2px 8px rgba(239, 68, 68, 0.2);
    }

    .btn-danger:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
    }

    .btn-icon {
      width: 18px;
      height: 18px;
      fill: currentColor;
    }

    .toggle-switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .toggle-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .toggle-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: var(--transition);
      border-radius: 34px;
    }

    .toggle-slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: var(--transition);
      border-radius: 50%;
    }

    input:checked+.toggle-slider {
      background-color: var(--secondary-color);
    }

    input:checked+.toggle-slider:before {
      transform: translateX(26px);
    }

    .toggle-label {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
    }

    .message {
      padding: 10px 15px;
      border-radius: var(--border-radius);
      margin-top: 15px;
      font-size: 0.9rem;
      display: none;
    }

    .message.success {
      background-color: rgba(46, 204, 113, 0.1);
      color: #2ecc71;
      border: 1px solid rgba(46, 204, 113, 0.2);
    }

    .message.error {
      background-color: rgba(231, 76, 60, 0.1);
      color: #e74c3c;
      border: 1px solid rgba(231, 76, 60, 0.2);
    }

    .message.warning {
      background-color: rgba(243, 156, 18, 0.1);
      color: #f39c12;
      border: 1px solid rgba(243, 156, 18, 0.2);
    }

    .muted {
      color: #666;
      font-size: 0.9rem;
    }

    /* Search Container */
    .search-container {
      position: relative;
      margin-bottom: 15px;
    }

    .search-icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      width: 18px;
      height: 18px;
      fill: #999;
    }

    .search-input {
      padding: 12px 12px 12px 40px;
      border: 1px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 1rem;
      width: 100%;
      transition: var(--transition);
    }

    .search-input:focus {
      outline: none;
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 2px rgba(139, 107, 61, 0.2);
    }

    .clear-search {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      color: #999;
      cursor: pointer;
      display: none;
    }

    .clear-search:hover {
      color: #666;
    }

    .user-list {
      max-height: 200px;
      overflow-y: auto;
      border: 1px solid #eee;
      border-radius: var(--border-radius);
      margin-bottom: 15px;
    }

    .user-item {
      padding: 12px 15px;
      border-bottom: 1px solid #f5f5f5;
      cursor: pointer;
      transition: var(--transition);
    }

    .user-item:hover {
      background-color: var(--light-color);
    }

    .user-item.selected {
      background-color: rgba(139, 107, 61, 0.1);
      border-left: 3px solid var(--secondary-color);
    }

    .user-item:last-child {
      border-bottom: none;
    }

    .user-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .user-name {
      font-weight: 500;
    }

    .user-email {
      color: #666;
      font-size: 0.85rem;
    }

    .user-role {
      background: var(--light-color);
      color: var(--primary-color);
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.8rem;
    }

    .no-results {
      padding: 20px;
      text-align: center;
      color: #666;
      font-style: italic;
    }

    .search-stats {
      font-size: 0.8rem;
      color: #666;
      margin-bottom: 10px;
    }

    .security-info {
      background: #f8f9fa;
      border-radius: var(--border-radius);
      padding: 15px;
      margin-top: 15px;
    }

    .security-item {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .security-icon {
      width: 16px;
      height: 16px;
      fill: #2ecc71;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: white;
      border-radius: var(--border-radius);
      padding: 30px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-header h3 {
      color: var(--primary-color);
      font-size: 1.3rem;
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #666;
    }

    .close-modal:hover {
      color: #333;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 25px;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .sidebar {
        width: 70px;
      }

      .brand h1,
      .nav-links a span:not(.nav-icon),
      .logout-btn span:not(.logout-icon) {
        display: none;
      }

      .brand {
        justify-content: center;
        padding: 20px 10px;
      }

      .main-content {
        margin-left: 70px;
      }

      .nav-links a {
        justify-content: center;
        padding: 14px;
      }
    }

    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
        flex-direction: row;
        padding: 15px;
      }

      .brand {
        padding: 0 15px;
        margin-bottom: 0;
        border-bottom: none;
        border-right: 1px solid rgba(255, 255, 255, 0.15);
      }

      .nav-links {
        flex-direction: row;
        overflow-x: auto;
        padding: 0 10px;
      }

      .nav-links li {
        margin-bottom: 0;
        margin-right: 5px;
      }

      .logout-section {
        margin-top: 0;
        padding: 0 10px;
        border-top: none;
        border-left: 1px solid rgba(255, 255, 255, 0.15);
      }

      .main-content {
        margin-left: 0;
        padding: 25px 20px;
      }

      .top-row {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }

      .admin-section {
        width: 100%;
        justify-content: space-between;
      }

      .form-row {
        flex-direction: column;
      }

      .form-control {
        min-width: 100%;
      }
    }
  </style>
</head>

<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="brand">
      <img src="../shared/Hechlink_logo.png" alt="School Portal Logo" class="brand-icon">
      <h1>School Portal</h1>
    </div>

    <ul class="nav-links">
      <li><a href="admindashboard.html">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path d="M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z" />
          </svg>
          <span>Dashboard</span>
        </a></li>
      <li><a href="students.html">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path
              d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
          </svg>
          <span>Students</span>
        </a></li>
      <li><a href="parents.html">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path
              d="M16 17V19H2V17S2 13 9 13 16 17 16 17M12.5 7.5A3.5 3.5 0 1 0 9 11A3.5 3.5 0 0 0 12.5 7.5M15.94 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13M15 4A3.39 3.39 0 0 0 13.07 4.59A5 5 0 0 1 13.07 10.41A3.39 3.39 0 0 0 15 11A3.5 3.5 0 0 0 15 4Z" />
          </svg>
          <span>Parents</span>
        </a></li>
      <li><a href="staff.html">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path
              d="M21.1,12.5L22.5,13.91L15.97,20.5L12.5,17L13.9,15.59L15.97,17.67L21.1,12.5M10,17L13,20H3V18C3,15.79 6.58,14 11,14L12.89,14.11L10,17M11,4A4,4 0 0,1 15,8A4,4 0 0,1 11,12A4,4 0 0,1 7,8A4,4 0 0,1 11,4Z" />
          </svg>
          <span>Staff</span>
        </a></li>
      <li><a href="student-id-generator.html">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path
              d="M14,21H10V19H14M17.71,5.29L19.79,7.37L18.37,8.79L16.29,6.71M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10Z" />
          </svg>
          <span>ID Generator</span>
        </a></li>
      <li><a href="adminsettings.html" class="active">
          <svg class="nav-icon" viewBox="0 0 24 24">
            <path
              d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z" />
          </svg>
          <span>Settings</span>
        </a></li>
    </ul>

    <div class="logout-section">
      <button class="logout-btn" id="sidebarLogout">
        <svg class="logout-icon" viewBox="0 0 24 24">
          <path
            d="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z" />
        </svg>
        Log Out
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="top-row">
      <h2>Settings</h2>
      <div class="admin-section">
        <div id="adminInfo" class="muted">Welcome back, Admin</div>
        <button class="logout-btn-top" id="topLogout">
          <svg class="logout-icon-top" viewBox="0 0 24 24">
            <path
              d="M16,17V14H9V10H16V7L21,12L16,17M14,2A2,2 0 0,1 16,4V6H14V4H5V20H14V18H16V20A2,2 0 0,1 14,22H5A2,2 0 0,1 3,20V4A2,2 0 0,1 5,2H14Z" />
          </svg>
          Log Out
        </button>
      </div>
    </div>

    <div class="card">
      <h3>Admin Profile</h3>
      <div class="form-group">
        <div class="form-row">
          <div class="form-control">
            <label for="profileName">Full Name</label>
            <input id="profileName" placeholder="Enter your full name" value="Administrator">
          </div>
          <div class="form-control">
            <label for="profileEmail">Email Address</label>
            <input id="profileEmail" type="email" placeholder="Enter your email" value="admin@example.com">
          </div>
        </div>
        <button id="saveProfileBtn" class="btn btn-primary">
          <svg class="btn-icon" viewBox="0 0 24 24">
            <path
              d="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z" />
          </svg>
          Save Profile
        </button>
        <div id="profileMessage" class="message"></div>
      </div>
    </div>

    <div class="card">
      <h3>User Password Recovery</h3>
      <p class="muted" style="margin-bottom: 15px;">Reset passwords for users who have forgotten their credentials.</p>

      <div class="form-group">
        <label>Find User</label>
        <div class="search-container">
          <svg class="search-icon" viewBox="0 0 24 24">
            <path
              d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
          </svg>
          <input type="text" id="userSearch" class="search-input" placeholder="Search by name, email, or role...">
          <button class="clear-search" id="clearSearch">âœ•</button>
        </div>
        <div class="search-stats" id="searchStats">Showing all users</div>

        <label>Select User</label>
        <div class="user-list" id="userList">
          <div class="user-item" data-user="ST001" data-name="Alex Johnson" data-email="alex.johnson@student.edu"
            data-role="Student">
            <div class="user-info">
              <div>
                <div class="user-name">Alex Johnson</div>
                <div class="user-email">alex.johnson@student.edu</div>
              </div>
              <span class="user-role">Student</span>
            </div>
          </div>
          <div class="user-item" data-user="ST002" data-name="Sophia Garcia" data-email="sophia.garcia@student.edu"
            data-role="Student">
            <div class="user-info">
              <div>
                <div class="user-name">Sophia Garcia</div>
                <div class="user-email">sophia.garcia@student.edu</div>
              </div>
              <span class="user-role">Student</span>
            </div>
          </div>
          <div class="user-item" data-user="ST003" data-name="Emma Chen" data-email="emma.chen@student.edu"
            data-role="Student">
            <div class="user-info">
              <div>
                <div class="user-name">Emma Chen</div>
                <div class="user-email">emma.chen@student.edu</div>
              </div>
              <span class="user-role">Student</span>
            </div>
          </div>
          <div class="user-item" data-user="P001" data-name="Maria Garcia" data-email="maria.garcia@email.com"
            data-role="Parent">
            <div class="user-info">
              <div>
                <div class="user-name">Maria Garcia</div>
                <div class="user-email">maria.garcia@email.com</div>
              </div>
              <span class="user-role">Parent</span>
            </div>
          </div>
          <div class="user-item" data-user="P002" data-name="Robert Chen" data-email="robert.chen@email.com"
            data-role="Parent">
            <div class="user-info">
              <div>
                <div class="user-name">Robert Chen</div>
                <div class="user-email">robert.chen@email.com</div>
              </div>
              <span class="user-role">Parent</span>
            </div>
          </div>
          <div class="user-item" data-user="S001" data-name="Sarah Wilson" data-email="sarah.wilson@staff.edu"
            data-role="Teacher">
            <div class="user-info">
              <div>
                <div class="user-name">Sarah Wilson</div>
                <div class="user-email">sarah.wilson@staff.edu</div>
              </div>
              <span class="user-role">Teacher</span>
            </div>
          </div>
          <div class="user-item" data-user="S002" data-name="James Rodriguez" data-email="james.rodriguez@staff.edu"
            data-role="Teacher">
            <div class="user-info">
              <div>
                <div class="user-name">James Rodriguez</div>
                <div class="user-email">james.rodriguez@staff.edu</div>
              </div>
              <span class="user-role">Teacher</span>
            </div>
          </div>
          <div class="user-item" data-user="S003" data-name="Lisa Thompson" data-email="lisa.thompson@staff.edu"
            data-role="Administrator">
            <div class="user-info">
              <div>
                <div class="user-name">Lisa Thompson</div>
                <div class="user-email">lisa.thompson@staff.edu</div>
              </div>
              <span class="user-role">Administrator</span>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-control">
            <label for="recoveryMethod">Recovery Method</label>
            <select id="recoveryMethod">
              <option value="email">Send Reset Link via Email</option>
              <option value="temporary">Generate Temporary Password</option>
              <option value="manual">Manual Reset</option>
            </select>
          </div>
        </div>

        <div id="manualResetSection" style="display: none;">
          <div class="form-row">
            <div class="form-control">
              <label for="newPassword">New Password</label>
              <input id="newPassword" type="password" placeholder="Enter new password">
            </div>
            <div class="form-control">
              <label for="confirmPassword">Confirm Password</label>
              <input id="confirmPassword" type="password" placeholder="Confirm new password">
            </div>
          </div>
        </div>

        <div id="temporaryPasswordSection" style="display: none;">
          <div class="security-info">
            <h4 style="margin-bottom: 10px;">Temporary Password Security</h4>
            <div class="security-item">
              <svg class="security-icon" viewBox="0 0 24 24">
                <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
              </svg>
              <span>Password will expire in 24 hours</span>
            </div>
            <div class="security-item">
              <svg class="security-icon" viewBox="0 0 24 24">
                <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
              </svg>
              <span>User must change password on first login</span>
            </div>
            <div class="security-item">
              <svg class="security-icon" viewBox="0 0 24 24">
                <path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z" />
              </svg>
              <span>Password will be automatically generated</span>
            </div>
          </div>
        </div>

        <button id="initiateRecoveryBtn" class="btn btn-primary" disabled>
          <svg class="btn-icon" viewBox="0 0 24 24">
            <path
              d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z" />
          </svg>
          Initiate Password Recovery
        </button>
        <div id="recoveryMessage" class="message"></div>
      </div>
    </div>

    <div class="card">
      <h3>Security Settings</h3>
      <div class="form-group">
        <div class="toggle-label">
          <label for="twoFactorAuth">Two-Factor Authentication</label>
          <label class="toggle-switch">
            <input type="checkbox" id="twoFactorAuth">
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="toggle-label">
          <label for="sessionTimeout">Session Timeout (30 minutes)</label>
          <label class="toggle-switch">
            <input type="checkbox" id="sessionTimeout" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
        <div class="toggle-label">
          <label for="passwordPolicy">Enforce Strong Password Policy</label>
          <label class="toggle-switch">
            <input type="checkbox" id="passwordPolicy" checked>
            <span class="toggle-slider"></span>
          </label>
        </div>
        <button id="saveSecurityBtn" class="btn btn-primary">
          <svg class="btn-icon" viewBox="0 0 24 24">
            <path
              d="M12,1L3,5V11C3,16.55 6.84,21.74 12,23C17.16,21.74 21,16.55 21,11V5L12,1M12,7C13.4,7 14.8,8.6 14.8,10V11.5C15.4,11.5 16,12.1 16,12.7V16.5C16,17.1 15.4,17.7 14.8,17.7H9.2C8.6,17.7 8,17.1 8,16.5V12.6C8,12 8.6,11.4 9.2,11.4V10C9.2,8.6 10.6,7 12,7M12,8.2C11.2,8.2 10.5,8.7 10.5,9.5V11.5H13.5V9.5C13.5,8.7 12.8,8.2 12,8.2Z" />
          </svg>
          Save Security Settings
        </button>
        <div id="securityMessage" class="message"></div>
      </div>
    </div>

    <div class="card">
      <h3>System Preferences</h3>
      <div class="form-group">
        <div class="form-row">
          <div class="form-control">
            <label for="language">Language</label>
            <select id="language">
              <option value="en">English</option>
              <option value="es">Spanish</option>
              <option value="fr">French</option>
            </select>
          </div>
          <div class="form-control">
            <label for="timezone">Timezone</label>
            <select id="timezone">
              <option value="est">Eastern Time (EST)</option>
              <option value="cst">Central Time (CST)</option>
              <option value="mst">Mountain Time (MST)</option>
              <option value="pst" selected>Pacific Time (PST)</option>
            </select>
          </div>
        </div>
        <button id="savePreferencesBtn" class="btn btn-primary">
          <svg class="btn-icon" viewBox="0 0 24 24">
            <path
              d="M17.9,17.39C17.64,16.59 16.89,16 16,16H15V13A1,1 0 0,0 14,12H8V10H10A1,1 0 0,0 11,9V7H13A2,2 0 0,0 15,5V4.59C17.93,5.77 20,8.64 20,12C20,14.08 19.2,15.97 17.9,17.39M11,19.93C7.05,19.44 4,16.08 4,12C4,11.38 4.08,10.78 4.21,10.21L9,15V16A2,2 0 0,0 11,18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" />
          </svg>
          Save Preferences
        </button>
        <div id="preferencesMessage" class="message"></div>
      </div>
    </div>
  </main>

  <!-- Confirmation Modal -->
  <div class="modal" id="confirmationModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Confirm Password Reset</h3>
        <button class="close-modal">&times;</button>
      </div>
      <p>Are you sure you want to reset the password for <strong id="confirmUserName">User Name</strong>?</p>
      <p class="muted" style="margin-top: 10px;">This action cannot be undone. The user will receive instructions to set
        a new password.</p>
      <div class="modal-actions">
        <button class="btn btn-secondary" id="cancelReset">Cancel</button>
        <button class="btn btn-primary" id="confirmReset">Confirm Reset</button>
      </div>
    </div>
  </div>

  <script src="../runtime-config.js"></script>
  <script src="../shared/api-client.js"></script>
  <script src="app-api.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      // Authentication check
      ensureAuthRedirect();

      // Initialize settings page using app-api.js (for profile settings)
      if (typeof initSettingsPage === 'function') {
        initSettingsPage();
      }

      // Set admin info
      const adminEmail = localStorage.getItem('sv_admin_email') || 'admin';
      const adminInfoEl = document.getElementById('adminInfo');
      if (adminInfoEl) {
        adminInfoEl.textContent = `Welcome back, ${adminEmail.split('@')[0]}`;
      }

      // Logout functionality (using app-api.js function)
      function logout() {
        if (confirm('Are you sure you want to logout?')) {
          if (typeof doLogout === 'function') {
            doLogout();
          } else {
            localStorage.removeItem('sv_admin_token');
            localStorage.removeItem('sv_admin_email');
            window.location.href = '/public/landingpage.html';
          }
        }
      }

      // Add event listeners to logout buttons
      const sidebarLogout = document.getElementById('sidebarLogout');
      const topLogout = document.getElementById('topLogout');
      if (sidebarLogout) sidebarLogout.addEventListener('click', logout);
      if (topLogout) topLogout.addEventListener('click', logout);

      // Profile save functionality (app-api.js handles this, but keeping for UI consistency)
      const saveProfileBtn = document.getElementById('saveProfileBtn');
      if (saveProfileBtn) {
        saveProfileBtn.addEventListener('click', function () {
          const nameEl = document.getElementById('profileName');
          const emailEl = document.getElementById('profileEmail');
          if (nameEl && emailEl) {
            const name = nameEl.value;
            const email = emailEl.value;

            if (!name || !email) {
              showMessage('profileMessage', 'Please fill in all required fields', 'error');
              return;
            }

            // app-api.js initSettingsPage already handles saving, but we can show a message
            showMessage('profileMessage', 'Profile updated successfully!', 'success');
          }
        });
      }

      // Search functionality
      const userSearch = document.getElementById('userSearch');
      const clearSearch = document.getElementById('clearSearch');
      const userList = document.getElementById('userList');
      const searchStats = document.getElementById('searchStats');
      const userItems = document.querySelectorAll('.user-item');

      userSearch.addEventListener('input', function () {
        const searchTerm = this.value.toLowerCase().trim();
        let visibleCount = 0;

        // Show/hide clear button based on search input
        clearSearch.style.display = searchTerm ? 'block' : 'none';

        // Filter users
        userItems.forEach(item => {
          const name = item.getAttribute('data-name').toLowerCase();
          const email = item.getAttribute('data-email').toLowerCase();
          const role = item.getAttribute('data-role').toLowerCase();

          if (name.includes(searchTerm) || email.includes(searchTerm) || role.includes(searchTerm)) {
            item.style.display = 'block';
            visibleCount++;
          } else {
            item.style.display = 'none';
          }
        });

        // Update search stats
        if (searchTerm) {
          searchStats.textContent = `Found ${visibleCount} user${visibleCount !== 1 ? 's' : ''} matching "${searchTerm}"`;
        } else {
          searchStats.textContent = `Showing all ${visibleCount} users`;
        }

        // Clear selection if selected user is no longer visible
        const selectedItem = document.querySelector('.user-item.selected');
        if (selectedItem && selectedItem.style.display === 'none') {
          selectedItem.classList.remove('selected');
          selectedUser = null;
          document.getElementById('initiateRecoveryBtn').disabled = true;
        }
      });

      // Clear search functionality
      clearSearch.addEventListener('click', function () {
        userSearch.value = '';
        userSearch.dispatchEvent(new Event('input'));
        userSearch.focus();
      });

      // User selection functionality
      let selectedUser = null;

      userItems.forEach(item => {
        item.addEventListener('click', function () {
          // Remove selected class from all items
          userItems.forEach(i => i.classList.remove('selected'));
          // Add selected class to clicked item
          this.classList.add('selected');
          selectedUser = this.getAttribute('data-user');

          // Enable the recovery button
          document.getElementById('initiateRecoveryBtn').disabled = false;
        });
      });

      // Recovery method change
      document.getElementById('recoveryMethod').addEventListener('change', function () {
        const method = this.value;
        document.getElementById('manualResetSection').style.display = 'none';
        document.getElementById('temporaryPasswordSection').style.display = 'none';

        if (method === 'manual') {
          document.getElementById('manualResetSection').style.display = 'block';
        } else if (method === 'temporary') {
          document.getElementById('temporaryPasswordSection').style.display = 'block';
        }
      });

      // Initiate recovery
      document.getElementById('initiateRecoveryBtn').addEventListener('click', function () {
        if (!selectedUser) {
          showMessage('recoveryMessage', 'Please select a user first', 'error');
          return;
        }

        const method = document.getElementById('recoveryMethod').value;
        const selectedUserElement = document.querySelector('.user-item.selected');
        const userName = selectedUserElement.querySelector('.user-name').textContent;

        // Show confirmation modal
        document.getElementById('confirmUserName').textContent = userName;
        document.getElementById('confirmationModal').style.display = 'flex';
      });

      // Modal functionality
      document.querySelector('.close-modal').addEventListener('click', closeModal);
      document.getElementById('cancelReset').addEventListener('click', closeModal);

      function closeModal() {
        document.getElementById('confirmationModal').style.display = 'none';
      }

      // Confirm reset
      document.getElementById('confirmReset').addEventListener('click', function () {
        const method = document.getElementById('recoveryMethod').value;
        const selectedUserElement = document.querySelector('.user-item.selected');
        const userName = selectedUserElement.querySelector('.user-name').textContent;

        // Validate manual password reset
        if (method === 'manual') {
          const newPassword = document.getElementById('newPassword').value;
          const confirmPassword = document.getElementById('confirmPassword').value;

          if (!newPassword || !confirmPassword) {
            showMessage('recoveryMessage', 'Please enter and confirm the new password', 'error');
            closeModal();
            return;
          }

          if (newPassword !== confirmPassword) {
            showMessage('recoveryMessage', 'Passwords do not match', 'error');
            closeModal();
            return;
          }

          if (newPassword.length < 8) {
            showMessage('recoveryMessage', 'Password must be at least 8 characters', 'error');
            closeModal();
            return;
          }
        }

        // Simulate API call
        setTimeout(() => {
          let message = '';
          if (method === 'email') {
            message = `Password reset email sent to ${userName}`;
          } else if (method === 'temporary') {
            message = `Temporary password generated for ${userName}`;
          } else if (method === 'manual') {
            message = `Password manually reset for ${userName}`;
            // Clear password fields
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
          }

          showMessage('recoveryMessage', message, 'success');
          closeModal();

          // Reset selection
          userItems.forEach(i => i.classList.remove('selected'));
          selectedUser = null;
          document.getElementById('initiateRecoveryBtn').disabled = true;
        }, 1000);
      });

      // Security settings save
      document.getElementById('saveSecurityBtn').addEventListener('click', function () {
        // Simulate API call
        setTimeout(() => {
          showMessage('securityMessage', 'Security settings updated successfully!', 'success');
        }, 1000);
      });

      // Preferences save
      document.getElementById('savePreferencesBtn').addEventListener('click', function () {
        // Simulate API call
        setTimeout(() => {
          showMessage('preferencesMessage', 'Preferences saved successfully!', 'success');
        }, 1000);
      });

      // Helper function to show messages
      function showMessage(elementId, text, type) {
        const element = document.getElementById(elementId);
        element.textContent = text;
        element.className = `message ${type}`;
        element.style.display = 'block';

        // Hide message after 5 seconds
        setTimeout(() => {
          element.style.display = 'none';
        }, 5000);
      }
    });
  </script>
</body>

</html>